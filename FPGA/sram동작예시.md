# sram 동작 예시로 살펴보기

## 목차

- [용어정리](./sram동작예시.md#용어정리)
- [READ CYCLE 동작단계](./sram동작예시.md#4-read-cycle-동작-단계)
- [READ CYCLE의 타이밍 다이어그램 (시뮬레이션 결과)](./sram동작예시.md#타이밍-다이어그램-시뮬레이션-결과)
- [READ VHDL 구현 코드 예시](./sram동작예시.md#vhdl-구현-코드-예시)
- [WRITE CYCLE 동작단계](./sram동작예시.md#write-cycle-동작-단계)
- [WRITE CYCLE의 타이밍 다이어그램](./sram동작예시.md#타이밍-다이어그램)
- [WRITE VHDL 구현 코드 예시](./sram동작예시.md#vhdl-구현-예제)



예시 sram ) DS-1230W <br />

<a href = "https://www.analog.com/media/en/technical-documentation/data-sheets/DS1230W.pdf">Data sheet 열기</a>


## 용어정리

### 1. 전압 레벨 정의

- VIH (Voltage Input High) <br />
    - **의미**: 입력 신호가 논리 HIGH(1)로 인식되는 최소 전압
    - **DS1230W 값**: 2.2V
    - **설명**: 입력 핀에 2.2V 이상의 전압을 가하면 칩이 HIGH로 인식
    - 보통 Vcc의 Normal 값을 가한다. 여기선 3.3V

- VIL (Voltage Input Low) <br />

    - **의미**: 입력 신호가 논리 LOW(0)로 인식되는 최대 전압
    - **DS1230W 값**: 0.4V
    - **설명**: 입력 핀에 0.4V 이하의 전압을 가하면 칩이 LOW로 인식
    - **예시**: CE 핀에 0.3V → LOW로 인식 ✓

### 2. 타이밍 파라미터 (Timing Parameters)

- tRC (Read Cycle Time)
    - **의미**: 하나의 완전한 읽기 사이클에 걸리는 최소 시간
    - **DS1230W-100 값**: 100ns
    - **설명**: 연속된 읽기 동작 간 최소 간격. 이 시간보다 빠르게 읽으면 안됨
    - **중요**: FPGA 클럭이 14MHz 이하여야 안전 (1/100ns ≈ 10MHz)

- tACC (Address Access Time)
    - **의미**: 주소 안정화부터 데이터 유효까지의 시간
    - **DS1230W-100 값**: 100ns
    - **주소가 마지막에 변할 경우** 이 타이밍이 지배적
    - **설명**: 주소를 설정한 순간부터 100ns 이내에 데이터가 준비됨
    - **예시**: `t=0` 주소 입력 → `t=100ns` 데이터 유효

- tCO/tCE (Chip Enable to Output)

    - **의미**: CE 활성화부터 데이터 유효까지의 시간
    - **DS1230W-100 값**: 100ns
    - **CE가 마지막에 활성화될 경우** 이 타이밍이 지배적

- tOE (Output Enable time)
    - **의미**: OE 신호가 활성화된 후 출력이 유효해지기까지의 시간
    - **DS1230W-100 값**: 50ns
    - **설명**: 가장 빠른 타이밍이지만, ADDRESS와 CE가 이미 준비되어 있어야 함

- tOD (Output Disable Time)
    - **의미**: OE가 비활성화된 후 출력이 High-Z 상태로 가는 시간
    - **DS1230W-100 값**: 약 35ns
    - **설명**: OE를 HIGH로 만들면 35ns 이내에 출력 핀이 High-Impedance(고임피던스) 상태가 됨
    - **중요**: 버스 충돌 방지를 위해 필요한 시간

- tCOE (Chip Enable to Output Valid)
    - **의미**: CE 신호가 활성화된 후 출력이 유효해지기까지의 시간
    - **DS1230W-100 값**: 약 5ns
    - **설명**: CE를 LOW로 만든 후 출력 데이터가 준비되는 시간

### Write

- tWC (Write Cycle Time)
    - **의미:** 하나의 완전한 쓰기 사이클에 걸리는 최소 시간
    - **DS1230W-100 값:** 100ns
    - **설명:** 연속된 쓰기 동작 간 최소 간격. 이 시간보다 빠르게 쓰면 안됨
    - **중요:** FPGA 클럭이 10MHz 이하여야 안전 (1/100ns = 10MHz)
    - **예시:** 쓰기 1 완료 → 100ns 대기 → 쓰기 2 시작

- tWP (Write Pulse Width) ⭐ 가장 중요!

    - **의미:** WE 신호를 LOW 상태로 유지해야 하는 최소 시간

    - **DS1230W-100 값:** 75ns

    - **설명:** WE를 LOW로 만든 후 최소 75ns 동안 유지해야 데이터가 제대로 저장됨. 이 시간이 너무 짧으면 쓰기 실패!

    - **중요:** 10MHz 클럭(100ns 주기)이면 1 클럭으로 만족. 20MHz 클럭(50ns 주기)이면 2 클럭 필요

    - **예시:**
        ```
        t=0: WE = LOW (쓰기 시작)
        t=75ns: 최소 시간 만족
        t=100ns: WE = HIGH (상승 에지 → 데이터 저장!)
        ```


- tAW (Address Valid to End of Write)**

    - **의미:** 주소가 안정화된 시점부터 WE가 HIGH로 돌아가는 시점까지 주소를 유지해야 하는 최소 시간

    - **DS1230W-100 값:** 0ns (이론상 동시 가능)

    - **설명:** 주소를 설정한 후 WE가 HIGH로 올라갈 때까지 주소를 계속 유지해야 함. 데이터시트 값은 0ns이지만 실제로는 10~20ns 여유 권장

    - **실전:** 주소를 먼저 설정하고, 쓰기가 완전히 끝날 때까지 변경하지 말 것

    - **예시:**
        ```
        t=0: ADDR = 0x1234 (설정)
        t=10ns: 주소 안정화
        t=100ns: WE = HIGH (쓰기 완료)
        → 이 동안 주소 0x1234 유지
        ```

- tDS (Data Setup Time)

    - **의미:** WE가 HIGH로 올라가기 전에 데이터가 유효해야 하는 최소 시간

    - **DS1230W-100 값:** 40ns

    - **설명:** 데이터를 설정한 후 최소 40ns 이상 유지한 상태에서 WE를 HIGH로 만들어야 정확한 데이터가 저장됨

    - **중요:** WE 상승 에지에서 데이터가 래치되므로, 그 순간에 데이터가 안정적이어야 함

    - **예시:**
        ```
        t=0: DATA = 0xAB (데이터 설정)
        t=40ns: 최소 Setup Time 만족
        t=100ns: WE = HIGH (0xAB 저장!)
        ```

- tDH (Data Hold Time)

    - **의미:** WE가 HIGH로 올라간 후에도 데이터를 유지해야 하는 최소 시간

    - **DS1230W-100 값:** 0ns (실제 5~10ns 권장)

    - **설명:** WE 상승 에지가 완전히 끝날 때까지 데이터를 유지해야 안전하게 저장됨. 데이터시트는 0ns이지만 실제로는 5~10ns 유지 권장

    - **예시:**
        ```
        t=100ns: WE = HIGH (상승 에지)
        t=110ns: 데이터 변경 가능
        → 10ns 동안 데이터 유지
        ```

- tWR (Write Recovery Time)

    - **의미:** WE가 HIGH로 돌아간 후 다음 동작(READ/WRITE)을 시작하기 전 필요한 복구 시간

    - **DS1230W-100 값:** 5ns

    - **설명:** SRAM 내부 회로가 안정화되는 시간. 쓰기 완료 후 최소 5ns 대기해야 다음 동작 가능

    - **실전:** 10MHz 클럭이면 자동으로 만족되지만, 빠른 클럭에서는 주의 필요

    - **예시:**
        ```
        t=100ns: WE = HIGH (쓰기 완료)
        t=105ns: 다음 READ/WRITE 시작 가능
        ```

- tODW (Output Disable in Write)

    - **의미:** WE가 LOW로 떨어질 때 SRAM 출력 버퍼가 High-Z로 전환되는 시간

    - **DS1230W-100 값:** 35ns

    - **설명:** OE = LOW 상태에서 WE를 LOW로 만들면, SRAM이 자동으로 출력을 멈추고 입력 모드로 전환됨. 하지만 쓰기 시에는 처음부터 OE = HIGH로 하는 것이 안전함

    - **실전:** 이 파라미터에 의존하지 말고, 쓰기 전체 동안 OE = HIGH 유지!

    - **예시:**
        ```
        (권장하지 않는 시나리오)
        t=0: OE = LOW, SRAM 출력 중
        t=10: WE = LOW (쓰기 시작)
        t=45ns: SRAM 출력 High-Z로 (tODW)
        → 이보다는 처음부터 OE = HIGH!
        ```

- tOEW (Output Enable in Write)

    - **의미:** 쓰기 사이클 중 OE를 조작할 때의 타이밍 (실전에서는 사용 안 함)

    - **DS1230W-100 값:** 5ns

    - **설명:** 쓰기 중에 OE를 LOW로 만드는 경우의 타이밍. 하지만 쓰기 시에는 OE를 LOW로 만들면 안 되므로 이 파라미터는 무시해도 됨

    - **실전:** 쓰기 전체 동안 OE = HIGH 유지하면 이 파라미터는 신경 쓸 필요 없음



### 3. 제어 신호 (Control Signals)

- CE (Chip Enable) - Active LOW
    - **의미**: SRAM 칩을 활성화/비활성화하는 신호
    - **동작**:
        • CE = LOW (0V) → 칩 활성화, 읽기/쓰기 가능
        • CE = HIGH (VCC) → 칩 비활성화, 저전력 대기 상태
    - **용도**: 여러 메모리 칩 중 하나를 선택할 때 사용

- OE (Output Enable) - Active LOW
    - **의미**: 데이터 출력을 활성화/비활성화하는 신호
    - **동작**:
        • OE = LOW → 출력 활성화, 데이터가 I/O 핀에 출력됨
        • OE = HIGH → 출력 비활성화, I/O 핀이 High-Z 상태
    - **용도**: 버스 충돌 방지 (여러 장치가 같은 버스를 공유할 때)

- WE (Write Enable) - Active LOW
    - **의미**: 읽기/쓰기 모드를 결정하는 신호
    - **READ 사이클에서**:
        • WE = HIGH → 읽기 모드 (데이터를 읽음)
       **WRITE 사이클에서**:
        • WE = LOW → 쓰기 모드 (데이터를 씀)

### 4. READ CYCLE 동작 단계

datasheet 의 6-7 page에 나와있다.

```
ADDRESSES  ────────X═══════════════════X────────
                   ↑                   ↑
                 변화중              변화중
                   |← 주소 안정 구간 →|
```

**의미:**
- **X (크로스해치 영역)**: 주소가 이전 값에서 새 값으로 **전환되는 과도 구간**. 이 구간에서는 주소값이 부정확하므로 신뢰할 수 없음
- **═ (평평한 영역)**: 주소가 **안정화된 구간**. 이 구간에서만 SRAM이 정확한 주소를 인식할 수 있음

**왜 이렇게 그려지나?**
- 실제 회로에서 신호는 순간적으로 변하지 않고, 전환하는데 시간(수 nanosecond)이 걸림
- 이 "변화 구간"을 X로 표시하여 "이 시간 동안은 주소가 유효하지 않다"는 것을 명확히 보여준다

**실전 의미:**
- 읽기 동작을 시작하려면 주소가 먼저 안정화되어야 함
- CE나 OE를 활성화하기 전에 주소를 미리 설정해야 함

---

#### **2. CE (Chip Enable) - Active LOW**
```
CE  ────────╲_________________________╱────────
            ↓                         ↑
        LOW (활성)                HIGH (비활성)
```

**의미:**
- CE = LOW: 칩이 **활성화**되어 동작 가능 상태
- CE = HIGH: 칩이 **비활성화**되어 저전력 대기 상태

**타이밍 포인트:**
- CE가 LOW로 떨어지는 시점이 중요
- 여기서부터 **tCO (Chip Enable to Output)** 타이밍이 시작됨
- tCO ≈ 100ns: CE 활성화 후 100ns 이내에 데이터가 출력됨

**실전 의미:**
- 여러 개의 메모리 칩이 같은 버스를 공유할 때, CE로 특정 칩만 선택함
- 주소 디코더가 보통 CE 신호를 생성

---

#### **3. OE (Output Enable) - Active LOW**
```
OE  ────────╲_________________________╱────────
            ↓                         ↑
        LOW (출력 활성)           HIGH (출력 비활성)
```

**의미:**
- OE = LOW: I/O 핀이 **출력 모드**로 전환, 데이터가 핀에 출력됨
- OE = HIGH: I/O 핀이 **High-Z (고임피던스)** 상태, 다른 장치가 버스 사용 가능

**타이밍 포인트:**
- OE가 LOW로 떨어지는 시점부터 **tOE (Output Enable Time)** 측정
- tOE ≈ 50ns: OE 활성화 후 50ns 이내에 데이터가 출력됨

**실전 의미:**
- 버스 충돌 방지용임
- 여러 장치가 같은 데이터 버스를 공유할 때, OE로 출력을 제어함
- 쓰기 동작으로 전환할 때는 반드시 OE를 먼저 HIGH로 만들어야 한다

---

#### **4. WE (Write Enable)**
```
WE  ──────────────────────────────────────────
    (HIGH 유지 - 평평한 선)
```

**의미:**
- WE = HIGH: **읽기 모드**
- READ CYCLE 전체 동안 HIGH를 유지함

**왜 타이밍 다이어그램에 안 그려지거나 평평하게 그려지나?**
- 변화가 없기 때문
- 일부 데이터시트는 아예 생략하고, 일부는 평평한 HIGH 선으로 표시함

**실전 의미:**
- WE가 LOW로 가면 쓰기 모드로 전환됨
- READ 동작 중에는 절대 WE를 LOW로 만들면 안 된다!

---

#### **5. DATA OUT (I/O0~I/O7)**
```
DATA  ──────────────────══════════════──────────
                        ↑             ↑
                   데이터 유효    데이터 무효
```

**의미:**
- **처음 평평한 부분**: 이전 데이터 또는 High-Z 상태
- **══ (강조된 부분)**: **유효한 데이터 출력** 구간
- **마지막 평평한 부분**: CE/OE가 비활성화되면서 High-Z로 복귀

**타이밍 관계:**
데이터가 유효해지는 시점은 다음 **3가지 조건 중 가장 늦은 것**에 의해 결정된다:

1. **ADDRESS 안정화 + tACC (100ns)**
2. **CE 활성화 + tCO (100ns)**  
3. **OE 활성화 + tOE (40ns)**

---

### **동작 시나리오 예시**

**시나리오: 주소 0x1234의 데이터 읽기**
```
t = 0ns:    주소 변경 시작 (0x1234로)
t = 5ns:    주소 안정화 완료 ✓
t = 10ns:   CE = LOW (칩 선택)
t = 15ns:   OE = LOW (출력 활성화)
t = 110ns:  데이터 유효! (tCO = 100ns 경과)
            → FPGA가 데이터 읽기 시작
t = 200ns:  CE = HIGH (칩 비활성화)
t = 205ns:  OE = HIGH (출력 비활성화)
t = 225ns:  데이터 출력 High-Z로 복귀
```

---

### **FPGA 구현 시 주의사항**

1. **클럭 속도**: 10MHz 이하 권장 (1/100ns = 10MHz)

```
주기(ns) = 1,000,000,000 / 주파수(Hz)
주기(ns) = 1,000 / 주파수(MHz)

또는

주파수(MHz) = 1,000 / 주기(ns)
```

2. **타이밍 여유**: 실제로는 120~150ns 정도로 여유있게 설계

3. **신호 순서**:
```
   1. 주소 설정
   2. 10ns 대기 (주소 안정화)
   3. CE = LOW
   4. OE = LOW
   5. 100ns 대기 (tACC/tCO)
   6. 데이터 읽기
   7. CE = HIGH, OE = HIGH
```

## 타이밍 다이어그램 (시뮬레이션 결과)

```
클럭      : __/‾‾\_/‾‾\_/‾‾\_/‾‾\_/‾‾\_/‾‾\_/‾‾\_/‾‾\_/‾‾\__
           0   1   2   3   4   5   6   7   8   9

State     : IDLE|AS |AST|EN |WT1|WT2|RD |HLD|DIS|IDLE

ADDR      : ----<===0x1234===================>----

CE        : ‾‾‾‾‾‾‾‾‾‾‾‾\_______________/‾‾‾‾‾‾‾‾

OE        : ‾‾‾‾‾‾‾‾‾‾‾‾\_______________/‾‾‾‾‾‾‾‾

DATA      : --------########<==0xAB==>########----

read_done : ________________________________/‾‾\__

```

---

## WRITE CYCLE 동작 단계

### 1. 주소 설정 (Address Setup)

설명:

- 데이터를 쓸 메모리 주소를 A0~A14 핀에 출력
- 아직 CE, WE는 HIGH(비활성) 상태

### 2. 10~20ns 대기 (주소 안정화)

설명:

- 주소 신호가 FPGA → PCB → SRAM까지 전달되고 안정화되는 시간
- FPGA 출력 지연 + PCB 배선 지연

타이밍:

- tAW = 0ns이지만 실전에서는 여유 필요
- 10~20ns면 충분히 안전

### 3. 데이터 설정 (Data Setup)

설명:

- 메모리에 쓸 데이터를 I/O0~I/O7 핀에 출력한다
- 주소보다 늦게, WE 활성화보다 먼저 설정해야 함

타이밍:

- tDS = 40ns: WE가 HIGH로 올라가기 전 40ns 이상 데이터 유지 필요
- 따라서 WE를 조작하기 최소 40ns 전에 데이터 준비

### 4. CE = LOW, OE = HIGH (칩 활성화)

설명:

- CE = LOW: 칩을 활성화합니다
- OE = HIGH: 출력을 비활성화합니다 (버스 충돌 방지!)

왜 OE = HIGH?

- WRITE 시 I/O 핀은 "입력 모드"여야 함
- OE = LOW면 SRAM도 출력 → FPGA 출력과 충돌 → 회로 손상!
- 쓰기 전체 동안 OE = HIGH 유지 필수!

### 5. WE = LOW (쓰기 시작, 75ns 유지)

설명:

- WE를 LOW로 만들어 쓰기 모드로 전환
- tWP = 75ns: 최소 75ns 동안 LOW 상태 유지 필수!

이 시간 동안 SRAM 내부에서:

- 주소 디코딩
- 메모리 셀 접근
- 쓰기 회로 준비
- 데이터 대기

10MHz 클럭 (100ns 주기):

- 1 클럭 = 100ns > 75ns ✓ OK

20MHz 클럭 (50ns 주기):

- 1 클럭 = 50ns < 75ns ❌ 부족!
- 2 클럭 = 100ns > 75ns ✓ OK

### 6. WE = HIGH (상승 에지 → 데이터 저장!)

설명:

- WE가 LOW → HIGH로 전환되는 상승 에지에서 데이터가 메모리에 저장됨!
- 이것이 쓰기의 핵심 동작

조건 확인:

✅ 주소가 안정화되어 있어야 함 <br />
✅ 데이터가 tDS(40ns) 이상 유지되었어야 함 <br />
✅ WE가 tWP(75ns) 이상 LOW였어야 함 <br />

결과:

- 지정한 주소에 데이터가 저장됨
- 예: 주소 0x0014에 0xAB 저장 완료!


### 7. 5ns 대기 (Data Hold + Write Recovery)

설명:

- tDH = 0ns: 이론상 즉시 변경 가능하지만, 실제로는 5~10ns 유지 권장
- tWR = 5ns: SRAM 내부 회로 안정화 시간

이 시간 동안:

- 주소와 데이터를 그대로 유지
- SRAM 내부 회로가 안정화됨
- 다음 동작 준비

10MHz 클럭:

- 1 클럭 = 100ns이므로 충분히 만족

### 8. CE = HIGH, 완료 (신호 비활성화)

**설명:**
- CE를 HIGH로 만들어 칩을 비활성화
- SRAM이 저전력 대기 모드로 전환
- I/O 핀이 High-Z 상태로

**다음 동작까지:**
- **tWC = 100ns**: 다음 쓰기/읽기까지 최소 간격
- 10MHz 클럭이면 자연스럽게 만족

---

## 타이밍 다이어그램

```
시간:  0    100  200  300  400  500  600  700  800 (ns)
       |    |    |    |    |    |    |    |    |

ADDR:  ────X[0x0014]══════════════════════X────

DATA:  ────────X[0xAB]════════════════════X────

CE:    ────────────╲_____________________╱────

WE:    ──────────────────╲______╱─────────────
                         ↑      ↑
                      쓰기 시작  🎯 저장!
                         |←75ns→|

OE:    ──────────────────────────────────────
       (HIGH 유지)

tDS:              |←40ns→|
tWP:                     |←75ns→|
tDH:                            |→|
tWR:                            |→|
```
